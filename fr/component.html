<!doctype html>
<html dir="ltr" lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Créer un composant - Woc.ts, TypeScript Framework</title>
<link rel="stylesheet" media="all" href="woc.css">
<body>
<div class="global-wrapper">
<header class="site-header"><div class="area-wrapper">
	<a href="./">
		<h1>Woc.ts <small>[TypeScript Framework]</small></h1>
	</a>
	<p class="slogan">Well-Organized Code.</p>
</div></header>
<nav class="site-menu"><div class="area-wrapper">
	<ul class="menu-l0">
		<li class="menu-l0-li">
			<a class="menu-l0-li-button" href="debuter.html">Débuter</a>
			<ul class="menu-l1">
				<li class="menu-l1-li">
					<a class="menu-l1-li-button" href="application.html">Créer une application</a>
				</li>
				<li class="menu-l1-li">
					<a class="menu-l1-li-button" href="bundle.html">Créer un bundle</a>
				</li>
				<li class="menu-l1-li">
					<a class="menu-l1-li-button" href="component.html">Créer un composant</a>
				</li>
				<li class="menu-l1-li">
					<a class="menu-l1-li-button" href="service.html">Créer un service</a>
				</li>
				<li class="menu-l1-li">
					<a class="menu-l1-li-button" href="library.html">Inclure une <em>library</em></a>
				</li>
				<li class="menu-l1-li">
					<a class="menu-l1-li-button" href="woc-make.html">Déployer avec <em>woc-make</em></a>
				</li>
			</ul>
		</li>
		<li class="menu-l0-li">
			<a class="menu-l0-li-button" href="extensions.html">Extensions</a>
			<ul class="menu-l1">
				<li class="menu-l1-li">
					<a class="menu-l1-li-button" href="dataset.html">Les <em>datasets</em></a>
				</li>
			</ul>
		</li>
		<li class="menu-l0-li">
			<a class="menu-l0-li-button" href="telecharger.html">Télécharger</a>
			<ul class="menu-l1">
				<li class="menu-l1-li">
					<a class="menu-l1-li-button" href="https://github.com/tarh/woc.ts/releases/" target="_blank">Télécharger une release</a>
				</li>
				<li class="menu-l1-li">
					<a class="menu-l1-li-button" href="https://github.com/tarh/woc.ts/" target="_blank">Contribuer sur GitHub</a>
				</li>
			</ul>
		</li>
	</ul>
</div></nav>
<article class="page-art">
	<header class="art-header"><div class="area-wrapper">
		<h1>Créer un composant</h1>
	</div></header>
	<div class="area-wrapper">
	<div class="art-body readable-art-body with-text-links">
<p>Un composant encapsule du code JavaScript, des templates HTML, du code CSS et d'éventuelles autres ressources comme des
	images, dans un répertoire suffixé par <code>.c</code> et dont le parent est un bundle.</p>
<p>Une fois que le bundle dont il fait partie est chargé, le composant devient accessible globalement. N'importe quelle partie
	de l'application Woc peut instancier le composant.</p>
<p>Sa configuration est précisée dans un fichier « comp.json ». Voici le contenu du fichier « todos_List.c/comp.json » :</p>

<pre><code>{
	"woc": "0.7",
	"encoding": "utf8",
	"useLibraries": ["jQuery"],
	"useServices": [],
	"useComponents": [],
	"script": "List.js",
	"templates": "t.html",
	"css": "p.css",
	"name": "todos.List"
}
</code></pre>
<p>Note commune pour les composants et services : les dépendances sont mentionnées dans
	les éléments optionnels <code>useLibraries</code>,  <code>useServices</code>,  <code>useComponents</code>.</p>
<p>Note commune pour les composants et services : l'élément <code>name</code> doit contenir le nom complet de la classe qui
	implémente <code>Woc.Component</code>. Le nom du bundle ne devrait pas être relié à un nom de module TypeScript. La règle est
	de mentionner le module (en remplaçant les points par des underscores) dans le nom du répertoire du composant ou du service.</p>

<h2>Les <em>templates</em> HTML</h2>
<p>Les templates HTML sont déposés dans un fichier HTML, leur ordre n'importe pas. Ils sont ensuite sélectionnés depuis le code
	TypeScript au moyen d'une classe CSS, de l'ID ou du nom de la balise.</p>
<p>Un template est un élément HTML qui n'a pas de parent. Par exemple dans le fichier des templates du composant « todos_List »,
	un seul template est présent (l'élément <code>section</code>) :</p>
<pre><code>&lt;section class="todos-list"&gt;
	&lt;h1&gt;&lt;/h1&gt;
	&lt;ul&gt;&lt;/ul&gt;
	{<strong>placeholder</strong>:addBtn}
&lt;/section&gt;</code></pre>
<p>Lorsqu'un composant utilise un autre composant, on peut préciser l'endroit où aura lieu l'insertion au moyen d'un marqueur
	<code>{placeholder:leNomDuPlaceholder}</code>. Le nom du placeholder est libre. Il sert à sélectionner cet emplacement pour le
	remplacer par un élément HTML.</p>
<p>Woc ne fournit pas de langage de template complet. Si vous souhaitez insérer non pas un composant mais un nombre indéterminé
	d'instances d'un composant, vous le ferez dans le code TypeScript. C'est le cas ici : l'élément <code>ul</code> est rempli en
	TypeScript.</p>
<h2>Le code TypeScript du composant</h2>
<p>Voici un squelette de code TypeScript pour un composant :</p>
<pre><code>module todos {
	'use strict';
	export class List implements Woc.Component {
		constructor(private cc: Woc.ComponentContext, props: {}) {
			// Ici l'instanciation des templates
		}
		public setData(data) {
			// Ici le remplissage des templates par les données
		}
		public destruct(removeFromDOM: boolean) {
			// Ici les désabonnements
		}
	}
}</code></pre>

<p>Afin d'homogénéiser les composants, le noyau Woc définit plusieurs méthodes optionnelles. Par exemple la méthode
	<code>setData</code> de notre exemple est optionnelle. Le développeur n'est pas obligé de les implémenter.</p>
<p>La méthode <code>destruct</code> est optionnelle, elle contient le code de désabonnement aux évènements (par exemple
	l'annulation d'un <em>listener</em> exposé par un service) plus éventuellement la suppression de ses éléments dans le DOM. Cette méthode est
	optionnelle car en pratique le composant conteneur supprime souvent plus efficacement ses composants enfants dans le DOM
	(nœuds plus évènements liés). Cette méthode ne doit jamais être appelée directement, c'est le noyau de Woc qui
	s'en charge lors de la destruction d'un composant.</p>
<p>Voici un exemple d'instanciation d'un template :</p>
<pre><code>
	this.btn = cc.createComponent('ext.Button', {'label': 'Add'});
	this.$bloc = $(cc.<strong>getTemplate</strong>('.todos-list', {
		'addBtn': this.btn.getElement()
	}));
</code></pre>

<h2>Notes</h2>
<ol>
<li>Les dépendances envers les composants et services ne sont pas indiquées dans la configuration. Seules les dépendances envers
	les <em>libraries</em> le sont.</li>
<li>Les éléments <code>script</code>, <code>css</code> et <code>template</code> sont tous capables de recevoir une liste de
	fichiers. Les fichiers JavaScripts listés sont exécutés dans leur ordre d'apparition.</li>
<li>Pour des raisons de performance lors de l'interprétation des scripts, mieux vaut déclarer le <code>'use strict';</code> à
	l'intérieur du module plutôt qu'au niveau global.</li>
</ol>
<h2>Étapes suivantes</h2>
<p>→ <a href="service.html">Créer un service</a>.</p>
<p>→ <a href="library.html">Inclure une <em>library</em></a>.</p>
<p>→ <a href="woc-make.html">Déployer avec <em>woc-make</em></a>.</p>
</div>
	</div>
</article>
<footer class="site-footer with-text-links"><div class="area-wrapper">
	<p>NB. Lorsque Woc.ts passera en version 1.0, la documentation de référence passera en anglais.</p>
	<p>Woc.ts et le contenu de ce site sont dans le domaine public ou sous licence
		<a href="http://creativecommons.org/publicdomain/zero/1.0/" target="_blank">CC0</a> au choix.</p>
	<p>Woc.ts est développé par Tarh. Besoin d'aide ? C'est <a href="https://www.facebook.com/tarh.paleo" target="_blank">sur Facebook</a>.</p>
</div></footer>
</div>
